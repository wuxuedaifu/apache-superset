(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1080:function(t,e,o){"use strict";var n=c(o(1)),r=c(o(13)),i=o(2446),a=c(o(2448)),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e.default=t,e}(o(2449)),s=c(o(611));function c(t){return t&&t.__esModule?t:{default:t}}function l(t,e,o){var n=t,r=n.color_picker,a=e.data.arcs.map((function(t){return Object.assign({},t,{color:[r.r,r.g,r.b,255*r.a]})}));n.js_data_mutator&&(a=(0,s.default)(n.js_data_mutator)(a));return new i.ArcLayer(Object.assign({id:"path-layer-"+n.slice_id,data:a,strokeWidth:n.stroke_width?n.stroke_width:3},u.commonLayerProps(n,o)))}t.exports={default:function(t,e,o){var i,s,c=l(t.formData,e,t),p=Object.assign({},t.formData.viewport,{width:t.width(),height:t.height()});t.formData.autozoom&&(p=u.fitViewport(p,(i=e.data.arcs,s=[],i.forEach((function(t){s.push(t.sourcePosition),s.push(t.targetPosition)})),s))),r.default.render(n.default.createElement(a.default,{mapboxApiAccessToken:e.data.mapboxApiKey,viewport:p,layers:[c],mapStyle:t.formData.mapbox_style,setControlValue:o}),document.getElementById(t.containerId))},getLayer:l}},2448:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=c(o(1)),a=c(o(0)),u=c(o(2472)),s=c(o(2446));function c(t){return t&&t.__esModule?t:{default:t}}o(2480);var l={viewport:a.default.object.isRequired,layers:a.default.array.isRequired,setControlValue:a.default.func.isRequired,mapStyle:a.default.string,mapboxApiAccessToken:a.default.string.isRequired,onViewportChange:a.default.func},p={mapStyle:"light",onViewportChange:function(){}},f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.state={viewport:t.viewport},o.tick=o.tick.bind(o),o.onViewportChange=o.onViewportChange.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentWillMount",value:function(){var t=setInterval(this.tick,1e3);this.setState((function(){return{timer:t}}))}},{key:"componentWillReceiveProps",value:function(t){var e=this;this.setState((function(){return{viewport:Object.assign({},t.viewport),previousViewport:e.state.viewport}}))}},{key:"componentWillUnmount",value:function(){this.clearInterval(this.state.timer)}},{key:"onViewportChange",value:function(t){var e=Object.assign({},t);delete e.width,delete e.height;var o=Object.assign({},this.state.viewport,e);this.setState((function(){return{viewport:o}})),this.props.onViewportChange(o)}},{key:"tick",value:function(){var t=this;if(this.state.previousViewport!==this.state.viewport){var e=this.props.setControlValue,o=this.state.viewport;e&&e("viewport",o),this.setState((function(){return{previousViewport:t.state.viewport}}))}}},{key:"layers",value:function(){return this.props.layers.some((function(t){return"function"==typeof t}))?this.props.layers.map((function(t){return"function"==typeof t?t():t})):this.props.layers}},{key:"render",value:function(){var t=this.state.viewport;return i.default.createElement(u.default,n({},t,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),i.default.createElement(s.default,n({},t,{layers:this.layers(),initWebGLParameters:!0})))}}]),e}(i.default.Component);e.default=f,f.propTypes=l,f.defaultProps=p},2449:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBounds=u,e.fitViewport=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var n=u(e);return Object.assign({},t,(0,r.fitBounds)({height:t.height,width:t.width,padding:o,bounds:n}))}catch(e){return console.error("Could not auto zoom",e),t}},e.commonLayerProps=function(t,e){var o=t,r=void 0;if(o.js_tooltip){var a=(0,i.default)(o.js_tooltip);r=function(t){t.picked?e.setTooltip({content:n.default.sanitize(a(t)),x:t.x,y:t.y}):e.setTooltip(null)}}var u=void 0;o.js_onclick_href&&(u=function(t){var e=(0,i.default)(o.js_onclick_href)(t);window.open(e)});return{onClick:u,onHover:r,pickable:Boolean(r)}};var n=a(o(2461)),r=o(2457),i=a(o(611));function a(t){return t&&t.__esModule?t:{default:t}}function u(t){var e=d3.extent(t,(function(t){return t[1]})),o=d3.extent(t,(function(t){return t[0]}));return[[o[0],e[0]],[o[1],e[1]]]}},2477:function(t,e){},2478:function(t,e){},2479:function(t,e){}}]);