(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1078:function(t,e,n){"use strict";var o=c(n(1)),r=c(n(13)),i=n(2446),a=c(n(2448)),u=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(2449)),s=c(n(611));function c(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n){var o=t,r=o.color_picker,a=[r.r,r.g,r.b,255*r.a],c=e.data.features.map((function(t){return Object.assign({},t,{path:t.path,width:o.line_width,color:a})}));o.js_data_mutator&&(c=(0,s.default)(o.js_data_mutator)(c));return new i.PathLayer(Object.assign({id:"path-layer-"+o.slice_id,data:c,rounded:!0,widthScale:1},u.commonLayerProps(o,n)))}t.exports={default:function(t,e,n){var i,s,c=l(t.formData,e,t),p=Object.assign({},t.formData.viewport,{width:t.width(),height:t.height()});t.formData.autozoom&&(p=u.fitViewport(p,(i=e.data.features,s=[],i.forEach((function(t){s=s.concat(t.path)})),s))),r.default.render(o.default.createElement(a.default,{mapboxApiAccessToken:e.data.mapboxApiKey,viewport:p,layers:[c],mapStyle:t.formData.mapbox_style,setControlValue:n}),document.getElementById(t.containerId))},getLayer:l}},2448:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=c(n(1)),a=c(n(0)),u=c(n(2472)),s=c(n(2446));function c(t){return t&&t.__esModule?t:{default:t}}n(2480);var l={viewport:a.default.object.isRequired,layers:a.default.array.isRequired,setControlValue:a.default.func.isRequired,mapStyle:a.default.string,mapboxApiAccessToken:a.default.string.isRequired,onViewportChange:a.default.func},p={mapStyle:"light",onViewportChange:function(){}},f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={viewport:t.viewport},n.tick=n.tick.bind(n),n.onViewportChange=n.onViewportChange.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentWillMount",value:function(){var t=setInterval(this.tick,1e3);this.setState((function(){return{timer:t}}))}},{key:"componentWillReceiveProps",value:function(t){var e=this;this.setState((function(){return{viewport:Object.assign({},t.viewport),previousViewport:e.state.viewport}}))}},{key:"componentWillUnmount",value:function(){this.clearInterval(this.state.timer)}},{key:"onViewportChange",value:function(t){var e=Object.assign({},t);delete e.width,delete e.height;var n=Object.assign({},this.state.viewport,e);this.setState((function(){return{viewport:n}})),this.props.onViewportChange(n)}},{key:"tick",value:function(){var t=this;if(this.state.previousViewport!==this.state.viewport){var e=this.props.setControlValue,n=this.state.viewport;e&&e("viewport",n),this.setState((function(){return{previousViewport:t.state.viewport}}))}}},{key:"layers",value:function(){return this.props.layers.some((function(t){return"function"==typeof t}))?this.props.layers.map((function(t){return"function"==typeof t?t():t})):this.props.layers}},{key:"render",value:function(){var t=this.state.viewport;return i.default.createElement(u.default,o({},t,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),i.default.createElement(s.default,o({},t,{layers:this.layers(),initWebGLParameters:!0})))}}]),e}(i.default.Component);e.default=f,f.propTypes=l,f.defaultProps=p},2449:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBounds=u,e.fitViewport=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var o=u(e);return Object.assign({},t,(0,r.fitBounds)({height:t.height,width:t.width,padding:n,bounds:o}))}catch(e){return console.error("Could not auto zoom",e),t}},e.commonLayerProps=function(t,e){var n=t,r=void 0;if(n.js_tooltip){var a=(0,i.default)(n.js_tooltip);r=function(t){t.picked?e.setTooltip({content:o.default.sanitize(a(t)),x:t.x,y:t.y}):e.setTooltip(null)}}var u=void 0;n.js_onclick_href&&(u=function(t){var e=(0,i.default)(n.js_onclick_href)(t);window.open(e)});return{onClick:u,onHover:r,pickable:Boolean(r)}};var o=a(n(2461)),r=n(2457),i=a(n(611));function a(t){return t&&t.__esModule?t:{default:t}}function u(t){var e=d3.extent(t,(function(t){return t[1]})),n=d3.extent(t,(function(t){return t[0]}));return[[n[0],e[0]],[n[1],e[1]]]}},2477:function(t,e){},2478:function(t,e){},2479:function(t,e){}}]);